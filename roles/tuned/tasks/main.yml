---
# roles/tuned/tasks/main.yml

## Package Management

- name: "Manage tuned Packages"
  ansible.builtin.package:
    name: "{{ tuned_package_names }}"
    state: "{{ tuned_package_state }}"
  become: true
  notify:
    - "Restart tuned Service"
  tags:
    - "tuned"
    - "package"

## Configuration Management

- name: "Manage tuned Configuration"
  ansible.builtin.template:
    src: "{{ tuned_config_src }}"
    dest: "{{ tuned_config_dest }}"
    owner: "{{ tuned_config_owner }}"
    group: "{{ tuned_config_group }}"
    mode: "{{ tuned_config_mode }}"
  become: true
  notify:
    - "Restart tuned Service"
  tags:
    - "tuned"
    - "configuration"

## Service Management

- name: "Manage tuned Services"
  ansible.builtin.service:
    name: "{{ tuned_service_name }}"
    state: "{{ tuned_service_state }}"
    enabled: "{{ tuned_service_enabled }}"
  become: true
  when:
    - "tuned_package_state != 'absent'"
  tags:
    - "tuned"
    - "package"

## Firewall Management

- name: "Gather package Facts"
  ansible.builtin.package_facts:

- name: "Manage tuned Firewall Policy"
  ansible.posix.firewalld:
    service: "{{ tuned_firewall_service }}"
    state: "{{ tuned_firewall_state }}"
    zone: "{{ tuned_firewall_zone }}"
    immediate: "{{ tuned_firewall_immediate }}"
    permanent: "{{ tuned_firewall_permanent }}"
  become: true
  when:
    - "'firewalld' in ansible_facts.packages"
  tags:
    - "tuned"
    - "firewall"

## Checks

- name: "Import Checks for tuned"
  ansible.builtin.import_tasks: "check.yml"
  when:
    - "tuned_checks_enabled | bool"
  tags:
    - "tuned"
    - "check"
...
